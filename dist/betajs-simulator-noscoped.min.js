/*!
betajs-simulator - v0.0.7 - 2017-08-25
Copyright (c) Victor Lingenthal
Apache-2.0 Software License.
*/
(function(){var a=this.subScope();a.binding("module","global:BetaJS.Dynamics.Simulator"),a.binding("base","global:BetaJS"),a.binding("browser","global:BetaJS.Browser"),a.binding("dynamics","global:BetaJS.Dynamics"),a.define("module:",function(){return{guid:"a150338a-6525-40e5-b811-aa2de1afce26",version:"0.0.7"}}),a.assumeVersion("base:version","~1.0.96"),a.assumeVersion("browser:version","~1.0.65"),a.assumeVersion("dynamics:version","~0.0.83"),a.define("module:Components",["dynamics:Dynamic"],function(a,b){return a.extend({scoped:b},{template:'\n<layout-list ba-repeat="{{component :: components}}">\n    <div ba-click="current_component = component" ba-class="{{{selected: current_component === component}}}">\n        {{component.value}}\n    </div>\n</layout-list>\n',collections:{components:[]},create:function(){var a=document.location.hash.substring(1),b=this.get("components").first();this.get("components").iterate(function(c){c.get("value")===a&&(b=c)}),this.set("current_component",b)},events:{"change:current_component":function(a){document.location.hash=a.get("value")}}}).register()}),a.define("module:Controls",["dynamics:Dynamic"],function(a,b){return a.extend({scoped:b},{template:'\n<h4>Controls </h4>\n\n<controls>\n\n    <ba-layout></ba-layout>\n\n    <ba-components ba-components="{{components}}"></ba-components>\n\n</controls>'}).register()}),a.define("module:Layout",["dynamics:Dynamic"],function(a,b){return a.extend({scoped:b},{template:'<layout-list ba-repeat="{{system :: systems}}">\n    <div ba-click="current_system = system" ba-class="{{{selected: current_system === system}}}">\n        {{system.value}}\n    </div>\n</layout-list>\n\n<layout-list ba-repeat="{{device :: mobile}}">\n    <div ba-click="current_device = device" ba-class="{{{selected: current_device === device}}}">\n        {{device.value}}\n    </div>\n</layout-list>\n',collections:{systems:[{value:"mobile"},{value:"web"}],mobile:[{value:"iphone4"},{value:"iphone5"}],web:[{value:"notebook"}]},create:function(){this.set("current_system",this.get("systems").first()),this.set("current_device",this.get("mobile").first())}}).register()}),a.define("module:Simulator",["dynamics:Dynamic"],function(a,b){return a.extend({scoped:b},{template:'\n<ba-controls ba-components="{{components}}"></ba-controls>\n\n<ba-viewport></ba-viewport>\n'}).register()}),a.define("module:Viewport",["dynamics:Dynamic","base:Promise","browser:Loader","base:Time","browser:Dom"],function(a,b,c,d,e,f){return a.extend({scoped:f},{template:'\n\n<appframe\n        class="\n            {{current_system.value}}\n            {{current_device.value}}\n        ">\n\n    <ba-{{current_component.value}} ba-attrs="{{current_component.attrs}}"></ba-{{current_component.value}}>\n    <custom-container></custom-container>\n\n</appframe>\n',initial:{bind:{current_component:"<>+[tagname='ba-components']:current_component",current_system:"<>+[tagname='ba-layout']:current_system",current_device:"<>+[tagname='ba-layout']:current_device"}},create:function(){this._updateCurrentComponent()},events:{"change:current_component":function(){this._updateCurrentComponent()}},customContainer:function(){return this.activeElement().querySelector("custom-container")},_updateCurrentComponent:function(){var a=this.get("current_component");if(a){if(a.get("system")){var f=this.scope("<>+[tagname='ba-layout']").get("systems");this.set("current_system",f.query({value:a.get("system")}).next())}this.customContainer().innerHTML="";var g=b.create();if(g.success(function(){a.get("customhtml")&&(this.customContainer().innerHTML=a.get("customhtml")),a.get("customscript")&&a.get("customscript")()},this),a.get("externalfile")){var h=a.get("externalfile");h+=(h.indexOf("?")>=0?"&":"?")+"rev="+d.now(),c.loadHtml(h,function(b){var c=e.elementsByTemplate(b);c.forEach(function(b){"test"==b.id&&a.set("customhtml","<div id='test'>"+b.innerHTML+"</div>"),"SCRIPT"==b.tagName&&a.set("customscript",new Function(b.innerHTML))}),a.set("externalfile",""),g.asyncSuccess(!0)})}else g.asyncSuccess(!0)}}}).register()})}).call(Scoped);